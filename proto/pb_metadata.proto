syntax = "proto3";

package pb_metadata;


// ---------------- Node Aware  ----------------

message UnitMeta {
  bool bootstrap_partition = 1;
}

message UnitInfo {
  uint64 id = 1;
  string advertise_address = 2;
}

message Unit {

}

// =============================================

// -------------- State Machine  ---------------


message Entry {

}


message MailPostChunk {
  uint64 partition_id = 1;
  repeated bytes payloads = 2;
}

message MailPostSummary {

}

message SnapshotData {
  uint64 id = 1;
  uint64 from = 2;
}

message SnapshotRequest {
  uint64 partition_id = 1;
  uint64 snapshot_id = 2;
}

message SnapshotChunk {
  string name = 1;
  uint32 index = 2;
  uint32 total = 3;
  bytes payload = 4;
}


service Metadata {

  rpc mail_post(stream MailPostChunk) returns(MailPostSummary);

  rpc load_snapshot(SnapshotRequest) returns (stream SnapshotChunk);
}

// =============================================